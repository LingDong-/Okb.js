"x"in[]||"y"in[]||"z"in[]?console.log("Warning: Faied to define xyz property of Arrays, vectors might not work as expected."):(Object.defineProperty(Array.prototype,"x",{get:function(){return this[0]},set:function(t){this[0]=t}}),Object.defineProperty(Array.prototype,"y",{get:function(){return this[1]},set:function(t){this[1]=t}}),Object.defineProperty(Array.prototype,"z",{get:function(){return this[2]},set:function(t){this[2]=t}}));var Okb=new function(){var t=this;this.vector=new function(){var t=this;function n(n){return t.vector(n.x||0,n.y||0,n.z||0)}this.vector=function(t,n,r,e){var o=e;if(o instanceof Array)return[t,n].concat(null!=r&&null!=o.z?[r]:[]);var a=null==e?{x:t,y:n}:Object.assign({},e,{x:t,y:n});return null==r||null!=o&&null==o.z||(a.z=r),a},this.forward=t.vector(0,0,1),this.up=t.vector(0,1,0),this.right=t.vector(1,0,0),this.zero=t.vector(0,0,0),this.rotateAxial=function(r,e,o){r=n(r);var[a,i,l]=[e.x,e.y,e.z],[u,h,s]=[r.x,r.y,r.z],[c,f]=[Math.cos(o),Math.sin(o)],v={};return v[11]=a*a*(1-c)+c,v[12]=i*a*(1-c)-l*f,v[13]=l*a*(1-c)+i*f,v[21]=a*i*(1-c)+l*f,v[22]=i*i*(1-c)+c,v[23]=l*i*(1-c)-a*f,v[31]=a*l*(1-c)-i*f,v[32]=i*l*(1-c)+a*f,v[33]=l*l*(1-c)+c,t.vector(u*v[11]+h*v[12]+s*v[13],u*v[21]+h*v[22]+s*v[23],u*v[31]+h*v[32]+s*v[33],r)},this.rotateEuler=function(n,r){return 0!=r.z&&(n=t.rotateAxial(n,t.forward,r.z)),0!=r.x&&(n=t.rotateAxial(n,t.right,r.x)),0!=r.y&&(n=t.rotateAxial(n,t.up,r.y)),n},this.copy=function(n){return t.vector(n.x,n.y,n.z,n)},this.scale=function(n,r){return t.vector(n.x*r,n.y*r,n.z*r,n)},this.add=function(){for(var n=t.vector(0,0,0,arguments[0]),r=0;r<arguments.length;r++)"number"==typeof arguments[r]?(n.x+=arguments[r]||0,n.y+=arguments[r]||0,n.z+=arguments[r]||0):(n.x+=arguments[r].x||0,n.y+=arguments[r].y||0,n.z+=arguments[r].z||0);return n},this.multiply=function(){for(var n=t.vector(1,1,1),r=0;r<arguments.length;r++)"number"==typeof arguments[r]?(n.x*=arguments[r]||0,n.y*=arguments[r]||0,n.z*=arguments[r]||0):(n.x*=arguments[r].x||0,n.y*=arguments[r].y||0,n.z*=arguments[r].z||0);return t.vector(n.x,n.y,n.z,arguments[0])},this.subtract=function(r,e){var o=n(r);return e=n(e),t.vector(o.x-e.x,o.y-e.y,o.z-e.z,r)},this.magnitude=function(t){return t=n(t),Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},this.normalize=function(r){var e=r;r=n(r);var o=1/t.magnitude(r);return t.vector(r.x*o,r.y*o,r.z*o,e)},this.lerp=function(r,e,o){var a=n(r),i=n(e);return t.vector(a.x*(1-o)+i.x*o,a.y*(1-o)+i.y*o,a.z*(1-o)+i.z*o,r)},this.distance=function(){for(var t=0,r=0;r<arguments.length-1;r++){var e=n(arguments[r]),o=n(arguments[r+1]);t+=Math.sqrt(Math.pow(e.x-o.x,2)+Math.pow(e.y-o.y,2)+Math.pow(e.z-o.z,2))}return t},this.dot=function(t,r){return t=n(t),r=n(r),t.x*r.x+t.y*r.y+t.z*r.z},this.cross=function(r,e){var o=r;return r=n(r),e=n(e),t.vector(r.y*e.z-r.z*e.y,r.z*e.x-r.x*e.z,r.x*e.y-r.y*e.x,o)},this.cosine=function(n,r){return t.dot(n,r)/(t.magnitude(n)*t.magnitude(r))},this.angle=function(n,r){return Math.acos(t.cosine(n,r))},this.elementwise=function(n,r){return t.vector(r(n.x),r(n.y),r(n.z),n)},this.toColumn=function(t){return[[t.x],[t.y],[t.z]]},this.toRow=function(t){return[[t.x,t.y,t.z]]}},this.random=new function(){var n,r=this,e=function(){var t,n,r=4294967296;return{setSeed:function(e){n=t=(null==e?Math.random()*r:e)>>>0},getSeed:function(){return t},rand:function(){return(n=(1664525*n+1013904223)%r)/r}}},o=4,a=.5,i=function(t){return.5*(1-Math.cos(t*Math.PI))};this.perlin=function(t,r,e){if(r=r||0,e=e||0,null==n){n=new Array(4096);for(var l=0;l<4096;l++)n[l]=Math.random()}t<0&&(t=-t),r<0&&(r=-r),e<0&&(e=-e);for(var u,h,s,c,f,v=Math.floor(t),p=Math.floor(r),d=Math.floor(e),y=t-v,M=r-p,g=e-d,x=0,m=.5,b=0;b<o;b++){var z=v+(p<<4)+(d<<8);u=i(y),h=i(M),s=n[4095&z],s+=u*(n[z+1&4095]-s),c=n[z+16&4095],s+=h*((c+=u*(n[z+16+1&4095]-c))-s),c=n[4095&(z+=256)],c+=u*(n[z+1&4095]-c),f=n[z+16&4095],c+=h*((f+=u*(n[z+16+1&4095]-f))-c),x+=(s+=i(g)*(c-s))*m,m*=a,v<<=1,p<<=1,d<<=1,(y*=2)>=1&&(v++,y--),(M*=2)>=1&&(p++,M--),(g*=2)>=1&&(d++,g--)}return x},this.perlinDetail=function(t,n){t>0&&(o=t),n>0&&(a=n)},this.perlinSeed=function(t){var r=e();r.setSeed(t),n=new Array(4096);for(var o=0;o<4096;o++)n[o]=r.rand()};var l=void 0,u=void 0,h=[];this.simplexSeed=function(t){var n=e();n.setSeed(t),u=[];for(var r=0;r<256;r++)u[r]=Math.floor(256*n.rand());for(r=0;r<512;r++)h[r]=u[255&r]},this.simplex=function(t,n,e,o){return t=null!=t?Math.abs(t):0,n=null!=n?Math.abs(n):0,e=null!=e?Math.abs(e):0,o=null!=o?Math.abs(o):0,null==u&&r.simplexSeed((new Date).getTime()),null==l&&(l=new function(){var t=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],n=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]];function r(t,n,r,e,o){return t[0]*n+t[1]*r+t[2]*e+t[3]*o}this.noise=function(e,o,a,i){var l,u,s,c,f,v,p,d,y,M,g,x,m=h,b=(Math.sqrt(5)-1)/4,z=(5-Math.sqrt(5))/20,w=(e+o+a+i)*b,S=Math.floor(e+w),k=Math.floor(o+w),I=Math.floor(a+w),P=Math.floor(i+w),A=(S+k+I+P)*z,T=e-(S-A),N=o-(k-A),E=a-(I-A),O=i-(P-A),j=(T>N?32:0)+(T>E?16:0)+(N>E?8:0)+(T>O?4:0)+(N>O?2:0)+(E>O?1:0),B=T-(l=n[j][0]>=3?1:0)+z,q=N-(u=n[j][1]>=3?1:0)+z,C=E-(s=n[j][2]>=3?1:0)+z,D=O-(c=n[j][3]>=3?1:0)+z,L=T-(f=n[j][0]>=2?1:0)+2*z,X=N-(v=n[j][1]>=2?1:0)+2*z,W=E-(p=n[j][2]>=2?1:0)+2*z,F=O-(d=n[j][3]>=2?1:0)+2*z,K=T-(y=n[j][0]>=1?1:0)+3*z,Q=N-(M=n[j][1]>=1?1:0)+3*z,H=E-(g=n[j][2]>=1?1:0)+3*z,R=O-(x=n[j][3]>=1?1:0)+3*z,U=T-1+4*z,V=N-1+4*z,_=E-1+4*z,J=O-1+4*z,Z=255&S,G=255&k,Y=255&I,$=255&P,tt=m[Z+m[G+m[Y+m[$]]]]%32,nt=m[Z+l+m[G+u+m[Y+s+m[$+c]]]]%32,rt=m[Z+f+m[G+v+m[Y+p+m[$+d]]]]%32,et=m[Z+y+m[G+M+m[Y+g+m[$+x]]]]%32,ot=m[Z+1+m[G+1+m[Y+1+m[$+1]]]]%32,at=.6-T*T-N*N-E*E-O*O,it=.6-B*B-q*q-C*C-D*D,lt=.6-L*L-X*X-W*W-F*F,ut=.6-K*K-Q*Q-H*H-R*R,ht=.6-U*U-V*V-_*_-J*J;return 27*((at<0?0:(at*=at)*at*r(t[tt],T,N,E,O))+(it<0?0:(it*=it)*it*r(t[nt],B,q,C,D))+(lt<0?0:(lt*=lt)*lt*r(t[rt],L,X,W,F))+(ut<0?0:(ut*=ut)*ut*r(t[et],K,Q,H,R))+(ht<0?0:(ht*=ht)*ht*r(t[ot],U,V,_,J)))}}),.5*l.noise(t,n,e,o)+.5};var s=void 0;this.plasmaSeed=function(t){(s=e()).setSeed(t)},this.plasma=function(t){var n=null!=(t=null!=t?t:{}).n?t.n:1,e=null!=t.detail?t.detail:7;null==s&&r.plasmaSeed((new Date).getTime());for(var o=Math.pow(2,n),a=o+1,i=[],l=1/0,u=-1/0,h=0;h<a;h++){i.push([]);for(var c=0;c<a;c++)i[h].push(0)}function f(t){for(var n=0,r=0;r<t.length;r++)t[r]&&(n+=t[r]);return n/t.length}function v(t,n){try{return i[n][t]}catch(t){return 0}}function p(t,n,r){r<l&&(l=r),r>u&&(u=r),i[n][t]=r}function d(t,n,r){p(t,n,f([v(t-r,n-r),v(t+r,n-r),v(t+r,n+r),v(t-r,n+r)])+(2*s.rand()-1)*Math.pow(r,e))}function y(t,n,r){p(t,n,f([v(t,n-r),v(t+r,n),v(t,n+r),v(t-r,n)])+(2*s.rand()-1)*Math.pow(r,e))}!function t(n,r){var e,o,a=n/2;if(!(a<1)){for(o=a;o<r;o+=n)for(e=a;e<r;e+=n)d(e,o,a);for(o=0;o<=r;o+=a)for(e=(o+a)%n;e<=r;e+=n)y(e,o,a);return t(n/2,r)}}(o,o);var M=u-l;return function(t,n){return(i[Math.floor(Math.abs(n%2-1)*o)][Math.floor(Math.abs(t%2-1)*o)]-l)/M}};var c=0;this.valueNoiseSeed=function(t){c=t},this.valueNoise=function(t,n,r){function e(t,n,r){return.5+.5*(t=>t-Math.floor(t))((t+.12)*(n+.34)*(r+.56)*(t+n-r)*Math.PI+c*Math.E)}t=null!=t?Math.abs(t):0,n=null!=n?Math.abs(n):0,r=null!=r?Math.abs(r):0;var o=Math.floor(t),a=Math.floor(n),i=Math.floor(r),l=t-o,u=n-a,h=r-i,s=l*l*(3-2*l),f=u*u*(3-2*u),v=h*h*(3-2*h),p=e(o,a,i),d=e(o+1,a,i),y=e(o,a+1,i),M=e(o+1,a+1,i),g=e(o,a,i+1),x=e(o+1,a,i+1),m=e(o,a+1,i+1);return 2*(p+(d-p)*s+(y-p)*f+(g-p)*v+(p-d-y+M)*s*f+(p-y-g+m)*f*v+(p-d-g+x)*v*s+(-p+d+y-M+g-x-m+e(o+1,a+1,i+1))*s*f*v)-1},this.fractal=function(t,n){var r=null!=(n=null!=n?n:{}).f?n.f:1.98,e=null!=n.s?n.s:.49,o=null!=n.b?n.b:.5,a=null!=n.octaves?n.octaves:2,i=[[0,.8,.6],[-.8,.36,-.48],[-.6,-.48,.64]];return function(n,l,u){n=null!=n?n:0,l=null!=l?l:0,u=null!=u?u:0;for(var h=0,s=0;s<a;s++){var c=t(n,l,u);h+=o*c,o*=e;var f=r*(i[0][0]*n+i[0][1]*l+i[0][2]*u),v=r*(i[1][0]*n+i[1][1]*l+i[1][2]*u),p=r*(i[2][0]*n+i[2][1]*l+i[2][2]*u);n=f,l=v,u=p}return h}};var f=1234,v=999962000357,p=function(t){for(var n=function(t){try{return(t instanceof Buffer?t:Buffer.from(t.toString(),"binary")).toString("base64")}catch(n){return btoa(t)}}(JSON.stringify(t)),r=0,e=0;e<n.length;e++)r+=n.charCodeAt(e)*Math.pow(128,e);return r};this.randomSeed=function(t){var n=t;null==n&&(n=(new Date).getTime());var e=0,o=0;for(;e%999979==0||e%999983==0||0==e||1==e;)e=(p(n)+o)%v,o+=1;f=e;for(var a=0;a<10;a++)r.random()},this.random=function(){return(f=f*f%v)/v},this.seed=function(t){this.randomSeed(t),this.perlinSeed(t),this.plasmaSeed(t),this.simplexSeed(t),this.valueNoiseSeed(t)},this.overwriteDefault=function(){Math.randomSeed=this.randomSeed,Math.random=this.random},this.normalized=function(n,r){return t.math.map(Math.random(),0,1,n,r)},this.weighted=function(t){var n=Math.random();return Math.random()<t(n)?n:r.weighted(t)},this.weighted3d=function(t){var n=Math.random(),e=Math.random(),o=Math.random();return Math.random()<t(n,e,o)?{x:n,y:e,z:o}:r.weighted3d(t)},this.gaussian=function(){return r.weighted(t.curves.gaussian)},this.shuffle=function(t){var n,r,e;for(e=t.length-1;e>0;e--)n=Math.floor(Math.random()*(e+1)),r=t[e],t[e]=t[n],t[n]=r;return t},this.choice=function(t){return t[Math.floor(t.length*Math.random())]},this.loopNoise=function(t){var n=t/2/Math.PI,e=2*Math.PI/t;return function(t,o,a){o=null!=o?o:0,a=null!=a?a:0;var i=e*(t=null!=t?t:0),l=Math.cos(i)*n,u=Math.sin(i)*n;return r.perlin(n+l+a,n+u+a,o)}},this.tileNoise=function(t,n){var e=t/2/Math.PI,o=n/2/Math.PI,a=2*Math.PI/t,i=2*Math.PI/n;return function(t,n,l){l=null!=l?l:0;var u=a*(t=null!=t?t:0),h=i*(n=null!=n?n:0),s=Math.cos(u)*e,c=Math.sin(u)*e,f=Math.cos(h)*o,v=Math.sin(h)*o;return r.simplex(e+s+l,e+c+l,o+f+l,o+v+l)}},this.blue=function(n){var r=null!=(n=null!=n?n:{}).dimension?n.dimension:2,e=null!=n.iteration?n.iteration:20,o=null!=n.sampler?n.sampler:function(){return 1==r?{x:Math.random(),y:0,z:0}:2==r?{x:Math.random(),y:Math.random(),z:0}:3==r?{x:Math.random(),y:Math.random(),z:Math.random()}:void 0},a=[];return function(){for(var n=[],r=0;r<e;r++)n.push(o());var i=0,l=0;for(r=0;r<n.length;r++){for(var u=1/0,h=0;h<a.length;h++){var s=t.vector.distance(a[h],n[r]);s<u&&(u=s)}u>l&&(l=u,i=r)}return a.push(n[i]),n[i]}}},this.curves=new function(){var n=this,r=Math.pow,e=Math.exp,o=Math.cos,a=Math.sin;this.gaussian=function(t){return r(Math.E,-18*r(t-.5,2))},this.sigmoid=function(t,n){return 1/(1+e(-(n=null!=n?n:10)*(t-.5)))},this.inverseSigmoid=function(t,n){return n=null!=n?n:10,(-.1*Math.log(.00673795*(1/t-1))-.5)*(n/10)+.5},this.bean=function(t){return r(.25-r(t-.5,2),.5)*(2.6+2.4*r(t,1.5))*.54},this.squircle=function(t,n){return function(e){for(;e>Math.PI/2;)e-=Math.PI/2;for(;e<0;)e+=Math.PI/2;return t*r(1/(r(o(e),n)+r(a(e),n)),1/n)}},this.rationalQuadraticBezier=function(n,e,o,a,i){null==a&&(a=2);var l=r(1-i,2)+2*i*(1-i)*a+i*i;return t.vector.vector((r(1-i,2)*n.x+2*i*(1-i)*e.x*a+i*i*o.x)/l,(r(1-i,2)*n.y+2*i*(1-i)*e.y*a+i*i*o.y)/l,(r(1-i,2)*n.z+2*i*(1-i)*e.z*a+i*i*o.z)/l,n)},this.highBezier=function(r,e){return 1==r.length?r[0]:2==r.length?t.vector.lerp(r[0],r[1],e):t.vector.lerp(n.highBezier(r.slice(0,r.length-1),e),n.highBezier(r.slice(1),e),e)},this.smoothen=function(r,e){var o=null!=(e=null!=e?e:{}).weight?e.weight:1,a=null!=e.detail?e.detail:20;2==r.length&&(r=[r[0],t.geometry.midpoint(r[0],r[1]),r[1]]);for(var i=[],l=0;l<r.length-2;l++){var u,h,s;u=0==l?r[l]:t.geometry.midpoint(r[l],r[l+1]),h=r[l+1],s=l==r.length-3?r[l+2]:t.geometry.midpoint(r[l+1],r[l+2]);for(var c=a,f=0;f<c+(l==r.length-3);f+=1){var v=f/c;i.push(n.rationalQuadraticBezier(u,h,s,o,v))}}return i},this.fit=function(r,e){var o=null!=(e=null!=e?e:{}).smooth?e.smooth:.5,a=r;return 0!=e.smooth&&(a=n.smoothen(r,{weight:t.math.map(o,0,1,3,.5),detail:e.detail})),a.sort((t,n)=>t.x-n.x),function(n){for(var r=1;r<a.length;r++)if(n<a[r].x){var e=(n-a[r-1].x)/(a[r].x-a[r-1].x);return t.math.lerp(a[r-1].y,a[r].y,e)}return 0}}},this.math=new function(){this.map=function(t,n,r,e,o){return e+1*(t-n)/(r-n)*(o-e)},this.interpolate=function(t){return function(n,r,e){var o=t(e);return n*(1-o)+r*o}},this.lerp=this.interpolate(t=>t),this.matrixMultiply=function(t,n){for(var r=[],e=0;e<t.length;e++){r[e]=[];for(var o=0;o<n[0].length;o++){for(var a=0,i=0;i<t[0].length;i++)a+=t[e][i]*n[i][o];r[e][o]=a}}return r}},this.geometry=new function(){var n=this;this.midpoint=function(){var n=1==arguments.length?arguments[0]:Array.apply(null,arguments),r=t.vector.add.apply(null,n);return t.vector.vector(...t.vector.scale(r,1/n.length),n[0])},this.bound=function(n){for(var r=1/0,e=-1/0,o=1/0,a=-1/0,i=0;i<n.length;i++)n[i].x<r&&(r=n[i].x),n[i].x>e&&(e=n[i].x),n[i].y<o&&(o=n[i].y),n[i].y>a&&(a=n[i].y);return[t.vector.vector(r,o,0,n[0]),t.vector.vector(e,a,0,n[0])]},this.lineEquation=function(t,r){var[e,o]=n.slopeIntercept(t,r);return e!=1/0&&e!=-1/0?[e,-1,o]:[-1,0,t.x]},this.distanceToLine=function(t,r){var[e,o,a]=n.lineEquation(...r);return Math.abs(e*t.x+o*t.y+a)/Math.sqrt(e*e+o*o)},this.slopeIntercept=function(t,n){var r=n.x-t.x,e=n.y-t.y,o=r==1/0&&e==1/0||0==r&&0==e?1:e/r;return[o,t.y-o*t.x]},this.projectToQuad=function(r,e){var[o,a,i,l]=e;function u(r,e,o){var a,i=n.slopeIntercept(...e),l=n.slopeIntercept(...o),u=i[0]-l[0];if(Math.abs(u)<1e-5||Math.abs(i[0])==1/0&&Math.abs(l[0])==1/0){var h=n.distanceToLine(r,e),s=n.distanceToLine(r,o),c=n.distanceToLine(e[0],o);return Math.abs(h+s-c)>1e-5?-1:h/(h+s)}if(Math.abs(i[0])==1/0)a=[e[0].x,e[0].x*l[0]+l[1]];else if(Math.abs(l[0])==1/0)a=[o[0].x,o[0].x*i[0]+i[1]];else{var f=(l[1]-i[1])/u;a=[f,i[0]*f+i[1]]}var v=t.vector.subtract(e[0],a),p=t.vector.subtract(o[0],a),d=t.vector.subtract(r,a),y=t.vector.angle(v,d),M=t.vector.angle(v,p),g=t.vector.angle(d,p);return Math.abs(y)>Math.abs(M)||y/M<0||Math.abs(y+g-M)>1e-5?-1:y/M}var h=u(r,[o,l],[a,i]),s=u(r,[o,a],[l,i]);if(-1!=h&&-1!=s)return t.vector.vector(h,s,0,r)},this.intersect=function(r,e,o){null==o&&(o=!0);var a=n.slopeIntercept(...r),i=n.slopeIntercept(...e),l=a[0]-i[0];if(0==l)return!1;var u=(i[1]-a[1])/l,h=a[0]*u+a[1];function s(t,n){if(o)return Math.min(n[0].x,n[1].x)<=t.x&&t.x<=Math.max(n[0].x,n[1].x)&&Math.min(n[0].y,n[1].y)<=t.y&&t.y<=Math.max(n[0].y,n[1].y);return Math.min(n[0].x,n[1].x)+.01<t.x&&t.x<Math.max(n[0].x,n[1].x)-.01&&Math.min(n[0].y,n[1].y)+.01<t.y&&t.y<Math.max(n[0].y,n[1].y)-.01}return!(!s([u,h],r)||!s([u,h],e))&&t.vector.vector(u,h,0,r[0])},this.pointInPolygon=function(t,r){for(var e=0,o=0;o<r.length;o++){var a=r[o!=r.length-1?o+1:0];0!=n.intersect([r[o],a],[t,[Number.MAX_VALUE,Number.MAX_VALUE/3*Math.E]])&&e++}return e%2==1},this.polygonSides=function(t){for(var n=[],r=0;r<t.length;r++){var e=t[r],o=t[r!=t.length-1?r+1:0],a=Math.sqrt(Math.pow(o.x-e.x,2)+Math.pow(o.y-e.y,2));n.push(a)}return n},this.polygonArea=function(t){var r=n.polygonSides(t),e=r[0],o=r[1],a=r[2],i=(e+o+a)/2;return Math.sqrt(i*(i-e)*(i-o)*(i-a))},this.triangulate=function(t,r){var e=null!=(r=null!=r?r:{}).area?r.area:100,o=null!=r.convex&&r.convex,a=null==r.optimize||r.optimize;function i(t,r){var e=[[0,0],[0,0]],o=.01;e[0][0]=.99*t[0].x+t[1].x*o,e[0][1]=.99*t[0].y+t[1].y*o,e[1][0]=t[0].x*o+.99*t[1].x,e[1][1]=t[0].y*o+.99*t[1].y;for(var a=0;a<r.length;a++){var i=r[a],l=r[a!=r.length-1?a+1:0];if(0!=n.intersect(e,[i,l]))return!1}var u=n.midpoint(t);return 0!=n.pointInPolygon(u,r)}function l(t){return n.polygonArea(t)/n.polygonSides(t).reduce(function(t,n){return t+n},0)}function u(t,r){if(0==t.length)return[];if(n.polygonArea(t)<r)return[t];var e=n.polygonSides(t).reduce((t,n,r,e)=>n>e[t]?r:t,0),o=(e+1)%t.length,a=(e+2)%t.length;try{var i=n.midpoint([t[e],t[o]])}catch(n){return console.log("triangulation err:",t,n),[]}return u([t[e],i,t[a]],r).concat(u([t[a],t[o],i],r))}if(t.length<=3)return u(t,e);var h=function(t){for(var n=[],r=0;r<t.length;r++){var e=t[r],u=t[0!=r?r-1:t.length-1],h=t[r!=t.length-1?r+1:0],s=t.slice();if(s.splice(r,1),o||i([u,h],t)){var c=[[u,e,h],s];if(!a)return c;n.push(c)}}var f=[t,[]],v=0;for(r=0;r<n.length;r++){var p=l(n[r][0]);p>=v&&(f=n[r],v=p)}return f}(t);return u(h[0],e).concat(n.triangulate(h[1],r))},this.rectIntersect=function(t,n){return t.x<=n.x+n.width&&t.x+t.width>=n.x&&t.y<=n.y+n.height&&t.y+t.height>=n.y},this.tube=function(n,r){for(var e=n,o=(r=null!=r?r:t=>10,[]),a=[],i=1;i<e.length-1;i++){var l=r(i/e.length),u=Math.atan2(e[i].y-e[i-1].y,e[i].x-e[i-1].x),h=Math.atan2(e[i].y-e[i+1].y,e[i].x-e[i+1].x),s=(u+h)/2;s<h&&(s+=Math.PI);var c=l*Math.cos(s),f=l*Math.sin(s);o.push(t.vector.vector(e[i].x+c,e[i].y+f,e[i].z,e[i])),a.push(t.vector.vector(e[i].x-c,e[i].y-f,e[i].z,e[i]))}var v=e.length-1,p=Math.atan2(e[1].y-e[0].y,e[1].x-e[0].x)-Math.PI/2,d=(u=Math.atan2(e[v].y-e[v-1].y,e[v].x-e[v-1].x)-Math.PI/2,r(0)),y=r(1),M=d*Math.cos(p),g=d*Math.sin(p),x=y*Math.cos(u),m=y*Math.sin(u);return o.unshift(t.vector.vector(e[0].x+M,e[0].y+g,e[0].z,e[0])),a.unshift(t.vector.vector(e[0].x-M,e[0].y-g,e[0].z,e[0])),o.push(t.vector.vector(e[v].x+x,e[v].y+m,e[v].z,e[v])),a.push(t.vector.vector(e[v].x-x,e[v].y-m,e[v].z,e[v])),[o,a]},this.subdivide=function(n,r){for(var e=(n.length-1)*r,o=[],a=0;a<e;a+=1){var i=n[Math.floor(a/r)],l=n[Math.ceil(a/r)],u=a%r/r,h=t.vector.lerp(i,l,u);o.push(h)}return n.length>0&&o.push(n[n.length-1]),o},this.redivide=function(n,r){if(n.length<=1)return n;for(var e=t.vector.distance.apply(null,n)/r,o=0,a=t.vector.distance(n[0],n[1]),i=[],l=0,u=0;u<r+1;u++){for(;l>a+.01&&o<n.length-2;)l-=Math.max(a,.01),o+=1,a=t.vector.distance(n[o],n[o+1]),1;var h=l/a,s=t.vector.lerp(n[o],n[o+1],h);i.push(s),l+=e}return i},this.convexHull=function(t){t.length;var n=t.slice(),r=n.splice(function(t){for(var n=0,r=1/0,e=0;e<t.length;e++)t[e].y<r&&(r=t[e].y,n=e);return n}(t),1)[0],e=t=>Math.atan2(t.y-r.y,t.x-r.x);n.sort((t,n)=>e(t)-e(n)),n.unshift(r);var o,a,i,l=[];l.push(n[0]),l.push(n[1]);for(var u=2;u<n.length;u++){for(;l.length>=2&&(o=l[l.length-2],a=l[l.length-1],i=n[u],(a.x-o.x)*(i.y-o.y)-(a.y-o.y)*(i.x-o.x)<=0);)l.pop();l.push(n[u])}return l}},this.graphics=new function(){var n=this;this.BACKEND="canvas",this.CONTEXT=void 0,this.backend=function(t){n.BACKEND=t},this.context=function(t){n.CONTEXT=t},this.polygon=function(r){var e=null!=(r=null!=r?r:{}).context?r.context:n.CONTEXT,o=null!=r.backend?r.backend:n.BACKEND,a="fill"in r?r.fill:[255,255,255],i="stroke"in r?r.stroke:[0,0,0],l=null!=r.strokeWidth?r.strokeWidth:1,u=null!=r.offset?r.offset:{x:0,y:0},h=null==r.close||r.close;return function(n){if("canvas"==o){e.beginPath(),n.length>0&&e.moveTo(n[0].x+u.x,n[0].y+u.y);for(var r=1;r<n.length;r++)e.lineTo(n[r].x+u.x,n[r].y+u.y);null!=a&&(e.fillStyle=t.color.css(a),e.fill()),null!=i&&(h&&e.lineTo(n[0].x+u.x,n[0].y+u.y),e.strokeStyle=t.color.css(i),e.lineWidth=l,e.stroke())}else{if("svg"==o){var s='<path d ="M';for(r=0;r<n.length+!!h;r++)1==r&&(s+="L"),s+=n[r%n.length].x+u.x+" "+(n[r%n.length].y+u.y)+" ";return s+='" stroke="'+t.color.css(i)+(l>0?'" stroke-width="'+l:"")+'" fill="'+t.color.css(a),s+='"/>'}if("p5"==o){null!=a?e.fill.apply(null,a):e.noFill(),null!=i?(e.stroke.apply(null,i),e.strokeWeight(l)):e.noStroke(),e.beginShape();for(r=0;r<n.length+!!h;r++){var c=u.z,f=r%n.length;null!=n[f].z&&(c=c||0,e.vertex(n[f].x+u.x,n[f].y+u.y,n[f].z+c)),e.vertex(n[f].x+u.x,n[f].y+u.y)}e.endShape()}}}},this.brushstroke=function(r){var e=null!=(r=null!=r?r:{}).color?r.color:[0,0,0],o=Math.random()*Math.PI,a=null!=r.widthFunction?r.widthFunction:n=>10*Math.sin(n*Math.PI)*t.math.map(t.random.perlin(10*n,o),0,1,.7,1);return function(o){var i=null!=r.resample?r.resample:Math.ceil(t.vector.distance.apply(null,o)/10),l=Object.assign({},r,{fill:e,stroke:r.stroke}),u=o;i>0&&(u=t.geometry.redivide(u,i));var[h,s]=t.geometry.tube(u,a);return n.polygon(l)(h.concat(s.slice().reverse()))}},this.projectTexture=function(r){for(var e=null!=(r=null!=r?r:{}).context?r.context:n.CONTEXT,o=null!=r.backend?r.backend:n.BACKEND,a=null!=r.texture?r.texture:[[[0]]],i=null!=r.vertices?r.vertices:[[0,0],[64,0],[64,64],[0,64]],l=null!=r.pixelSize?r.pixelSize:1,[u,h]=t.geometry.bound(i),s="",c=u.x;c<h.x;c+=l)for(var f=u.y;f<h.y;f+=l){var v=t.geometry.projectToQuad([c,f],i);if(null!=v&&0<=v.x&&v.x<=1&&0<=v.y&&v.y<=1){var p;try{p=a[Math.floor(v.y*a.length)][Math.floor(v.x*a[0].length)]}catch(t){continue}null!=p&&("canvas"==o?(e.fillStyle=t.color.css(p),e.fillRect(c,f,l,l)):"p5"==o?(e.fill.apply(null,p),e.noStroke(),e.rect(c,f,l,l)):"svg"==o&&(s+='<path d="M'+c+" "+f+" h"+l+" v"+l+" h -"+l+' Z" fill="'+t.color.css(p)+'" stroke="none"/>'))}}if("svg"==o)return s}},this.color=new function(){var n=this;this.hsv=function(t,n,r){var e=r*n,o=e*(1-Math.abs(t/60%2-1)),a=r-e,[i,l,u]=[[e,o,0],[o,e,0],[0,e,o],[0,o,e],[o,0,e],[e,0,o]][Math.floor(t/60)];return[255*(i+a),255*(l+a),255*(u+a)]},this.css=function(){var t=Math.floor;return 1==arguments.length?null==arguments[0]?"none":"number"==typeof arguments[0]?"rgb("+t(arguments[0])+","+t(arguments[0])+","+t(arguments[0])+")":"string"==typeof arguments[0]?arguments[0]:n.css.apply(null,arguments[0]):2==arguments.length?"rgba("+t(arguments[0])+","+t(arguments[0])+","+t(arguments[0])+","+arguments[1]+")":3==arguments.length?"rgb("+t(arguments[0])+","+t(arguments[1])+","+t(arguments[2])+")":4==arguments.length?"rgba("+t(arguments[0])+","+t(arguments[1])+","+t(arguments[2])+","+arguments[3]+")":void 0},this.lerpHue=function(n,r,e){var o=[[Math.abs(r-n),t.math.map(e,0,1,n,r)],[Math.abs(r+360-n),t.math.map(e,0,1,n,r+360)],[Math.abs(r-360-n),t.math.map(e,0,1,n,r-360)]];return o.sort((t,n)=>t[0]-n[0]),(o[0][1]+720)%360}},this.texture=new function(){this.wood=function(n){for(var r=null!=(n=null!=n?n:{}).width?n.width:512,e=null!=n.height?n.height:512,o=null!=n.scale?n.scale:1,a=null!=n.grain?n.grain:1,i=null!=n.tile&&n.tile,l=null!=n.colorA?n.colorA:[100,50,10],u=null!=n.colorB?n.colorB:[210,162,104],h=[],s=0;s<e;s++){h.push([]);for(var c=0;c<r;c++)h[s].push([0,0,0])}var f=1/(o*r/512),v=e/5*o;for(s=0;s<e+v;s++)for(c=0;c<r;c++){var p=.001*f,d=.004*f,y=.1*f,M=.5*f;if(i)g=Math.floor(1e3*t.random.tileNoise(e*p,r*d)(s*p,c*d)*Math.pow(f,-.8)),x=Math.floor(90*t.random.tileNoise(e*y,r*M)(s*y,c*M)*a);else var g=Math.floor(1e3*t.random.perlin(s*p,c*d)*Math.pow(f,-.8)),x=Math.floor(90*t.random.perlin(s*y,c*M)*a);var m,b=[l[0]-x,l[1]-x,l[2]-x],z=[u[0]-x,u[1]-x,u[2]-x];m=g%40<30?t.vector.lerp(b,z,g%40/30):t.vector.lerp(b,z,(g%40-30)/10);var w=Math.round(s+t.random.perlin(.05*c*f)*v-v);0<=w&&w<e&&(h[w][c]=m)}return h},this.ricePaper=function(n){for(var r=null!=(n=null!=n?n:{}).width?n.width:512,e=null!=n.height?n.height:512,o=null!=n.color?n.color:[250,232,189],a=null!=n.grain?n.grain:20,i=null!=n.sprinkle?n.sprinkle:1,l=[],u=0;u<e;u++){l.push([]);for(var h=0;h<r;h++)l[u].push([0,0,0])}for(u=0;u<e;u++)for(h=0;h<r;h++){var s=255-t.random.perlin(.1*u,.1*h)*a*.5,c=(s-=Math.random()*a)*o[0]/255,f=s*o[1]/255,v=s*o[2]/255;(t.random.perlin(.04*u,.04*h,2)*Math.random()*i>.7||Math.random()<.005*i)&&(c=.7*s,f=.5*s,v=.2*s),l[u][h]=[c,f,v]}return l};this.knitPattern=function(n){for(var r=null!=(n=null!=n?n:{}).width?n.width:128,e=null!=n.height?n.height:128,o=null!=n.mono&&n.mono,a=null!=n.hue?n.hue:360*Math.random(),i=null!=n.scale?n.scale:10,l=[],u=0;u<e;u++){l.push([]);for(var h=0;h<r;h++)l[u].push(o?0:[0,0,0])}var s=function(n,r){return function(e,o,a){null==a&&(a=0);var i=n/2/Math.PI,l=e/n*(2*Math.PI),u=o/r*(2*Math.PI),h=i*Math.sin(l)*Math.cos(u),s=i*Math.sin(l)*Math.sin(u),c=i*Math.cos(l),f=i;return t.random.perlin(f+h,f+s,f+c+a)}}(i,i);for(u=0;u<e;u++)for(h=0;h<r;h++){var c=i*u/e,f=i*h/r;if(o){v=Math.floor(s(f,c));l[u][h]=[v,v,v]}else{var v=s(f,c),p=s(f,c,Math.E),d=s(f,c,Math.PI);l[u][h]=t.color.hsv(Math.floor((360*v+a)%360),p,d)}}return l}},this.explode=function(n){if(null==n&&(n=1),"object"==typeof window){var r=[];if(1==n)for(var e=Object.keys(t),o=0;o<e.length;o++)e[o]in window?console.log("identifier clash: ",e[o],", skipping..."):(window[e[o]]=t[e[o]],r.push(e[o]));else if(n>=2)for(e=Object.keys(t),o=0;o<e.length;o++)for(var a=Object.keys(t[e[o]]),i=0;i<a.length;i++)a[i]in window?console.log("identifier clash: ",a[i],", skipping..."):(window[a[i]]=t[e[o]][a[i]],r.push(a[i]));return console.log("exploded into global scope: ",r),r}console.log("`explode()` only works in browser mode!")}};"object"==typeof module&&(module.exports=Okb);
